<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="planner">
        <div class="sidebar">
            <h2 class="sidebar-title">Days</h2>
            <ul class="sidebar-nav">
                <li><a href="#monday" class="nav-link" onclick="closeSidebar()">Monday</a></li>
                <li><a href="#tuesday" class="nav-link" onclick="closeSidebar()">Tuesday</a></li>
                <li><a href="#wednesday" class="nav-link" onclick="closeSidebar()">Wednesday</a></li>
                <li><a href="#thursday" class="nav-link" onclick="closeSidebar()">Thursday</a></li>
                <li><a href="#friday" class="nav-link" onclick="closeSidebar()">Friday</a></li>
                <li><a href="#saturday" class="nav-link" onclick="closeSidebar()">Saturday</a></li>
                <li><a href="#sunday" class="nav-link" onclick="closeSidebar()">Sunday</a></li>
            </ul>
            <button class="sidebar-toggle" aria-label="Toggle sidebar">â˜°</button>
        </div>
        <div class="main-content">
            <h1 class="planner-title">Weekly Planner</h1>
            <div class="filter-sort">
                <label for="filter-tasks">Filter:</label>
                <select id="filter-tasks" onchange="filterTasks()" aria-label="Filter tasks">
                    <option value="all">All</option>
                    <option value="completed">Completed</option>
                    <option value="incomplete">Incomplete</option>
                </select>
                <button onclick="sortTasks()" aria-label="Sort tasks alphabetically">Sort A-Z</button>
            </div>
            <div class="days-grid">
                <div class="day-card" id="monday">
                    <div class="day-header">Monday</div>
                    <div class="task-list" id="monday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('monday')" aria-label="Add task for Monday">Add Task</button>
                </div>
                <div class="day-card" id="tuesday">
                    <div class="day-header">Tuesday</div>
                    <div class="task-list" id="tuesday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('tuesday')" aria-label="Add task for Tuesday">Add Task</button>
                </div>
                <div class="day-card" id="wednesday">
                    <div class="day-header">Wednesday</div>
                    <div class="task-list" id="wednesday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('wednesday')" aria-label="Add task for Wednesday">Add Task</button>
                </div>
                <div class="day-card" id="thursday">
                    <div class="day-header">Thursday</div>
                    <div class="task-list" id="thursday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('thursday')" aria-label="Add task for Thursday">Add Task</button>
                </div>
                <div class="day-card" id="friday">
                    <div class="day-header">Friday</div>
                    <div class="task-list" id="friday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('friday')" aria-label="Add task for Friday">Add Task</button>
                </div>
                <div class="day-card" id="saturday">
                    <div class="day-header">Saturday</div>
                    <div class="task-list" id="saturday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('saturday')" aria-label="Add task for Saturday">Add Task</button>
                </div>
                <div class="day-card" id="sunday">
                    <div class="day-header">Sunday</div>
                    <div class="task-list" id="sunday-tasks"></div>
                    <button class="add-task-btn" onclick="showTaskModal('sunday')" aria-label="Add task for Sunday">Add Task</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="task-modal" id="task-modal">
        <div class="modal-content">
            <h2 id="modal-title">Add New Task</h2>
            <input type="text" id="task-input" placeholder="Enter task description" aria-label="Task description">
            <div class="modal-buttons">
                <button id="modal-confirm" onclick="addTaskFromModal()" aria-label="Confirm task addition">Add</button>
                <button onclick="closeTaskModal()" aria-label="Cancel task addition">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        let currentDay = '';
        let editTaskElement = null;
        let isSortAscending = true;

        // Load tasks from localStorage
        function loadTasks() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            days.forEach(day => {
                const tasks = JSON.parse(localStorage.getItem(`tasks-${day}`)) || [];
                const taskList = document.getElementById(`${day}-tasks`);
                tasks.forEach(task => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    taskItem.innerHTML = `
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''} aria-label="Mark task as complete" onchange="updateTaskStatus('${day}', this)">
                        <span>${task.text}</span>
                        <button class="edit-btn" onclick="editTask(this, '${day}')" aria-label="Edit task">Edit</button>
                        <button class="delete-btn" onclick="deleteTask(this, '${day}')" aria-label="Delete task">Delete</button>
                    `;
                    taskList.appendChild(taskItem);
                });
            });
        }

        // Save tasks to localStorage
        function saveTasks(day) {
            const taskList = document.getElementById(`${day}-tasks`);
            const tasks = Array.from(taskList.children).map(item => ({
                text: item.querySelector('span').textContent,
                completed: item.querySelector('.task-checkbox').checked
            }));
            localStorage.setItem(`tasks-${day}`, JSON.stringify(tasks));
        }

        // Show task modal
        function showTaskModal(day, isEdit = false, taskText = '') {
            currentDay = day;
            editTaskElement = isEdit ? editTaskElement : null;
            document.getElementById('task-modal').style.display = 'flex';
            document.getElementById('task-input').value = taskText;
            document.getElementById('modal-title').textContent = isEdit ? 'Edit Task' : 'Add New Task';
            document.getElementById('modal-confirm').textContent = isEdit ? 'Save' : 'Add';
            document.getElementById('task-input').focus();
        }

        // Close task modal
        function closeTaskModal() {
            document.getElementById('task-modal').style.display = 'none';
            document.getElementById('task-input').value = '';
            editTaskElement = null;
        }

        // Add or edit task from modal
        function addTaskFromModal() {
            const taskText = document.getElementById('task-input').value;
            if (taskText) {
                const taskList = document.getElementById(`${currentDay}-tasks`);
                if (editTaskElement) {
                    // Edit existing task
                    editTaskElement.querySelector('span').textContent = taskText;
                    saveTasks(currentDay);
                } else {
                    // Add new task
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    taskItem.style.opacity = '0';
                    taskItem.innerHTML = `
                        <input type="checkbox" class="task-checkbox" aria-label="Mark task as complete" onchange="updateTaskStatus('${currentDay}', this)">
                        <span>${taskText}</span>
                        <button class="edit-btn" onclick="editTask(this, '${currentDay}')" aria-label="Edit task">Edit</button>
                        <button class="delete-btn" onclick="deleteTask(this, '${currentDay}')" aria-label="Delete task">Delete</button>
                    `;
                    taskList.appendChild(taskItem);
                    setTimeout(() => {
                        taskItem.style.opacity = '1';
                        taskItem.style.transform = 'translateY(0)';
                    }, 10);
                    saveTasks(currentDay);
                }
                closeTaskModal();
                filterTasks(); // Reapply filter after adding/editing
            }
        }

        // Edit task
        function editTask(button, day) {
            editTaskElement = button.parentElement;
            const taskText = editTaskElement.querySelector('span').textContent;
            showTaskModal(day, true, taskText);
        }

        // Delete task
        function deleteTask(button, day) {
            if (confirm('Are you sure you want to delete this task?')) {
                button.parentElement.remove();
                saveTasks(day);
                filterTasks();
            }
        }

        // Update task status
        function updateTaskStatus(day, checkbox) {
            saveTasks(day);
            filterTasks();
        }

        // Filter tasks
        function filterTasks() {
            const filter = document.getElementById('filter-tasks').value;
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            days.forEach(day => {
                const taskList = document.getElementById(`${day}-tasks`);
                Array.from(taskList.children).forEach(taskItem => {
                    const isCompleted = taskItem.querySelector('.task-checkbox').checked;
                    if (filter === 'all') {
                        taskItem.style.display = 'flex';
                    } else if (filter === 'completed' && !isCompleted) {
                        taskItem.style.display = 'none';
                    } else if (filter === 'incomplete' && isCompleted) {
                        taskItem.style.display = 'none';
                    } else {
                        taskItem.style.display = 'flex';
                    }
                });
            });
        }

        // Sort tasks
        function sortTasks() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            days.forEach(day => {
                const taskList = document.getElementById(`${day}-tasks`);
                const tasks = Array.from(taskList.children);
                tasks.sort((a, b) => {
                    const textA = a.querySelector('span').textContent.toLowerCase();
                    const textB = b.querySelector('span').textContent.toLowerCase();
                    return isSortAscending ? textA.localeCompare(textB) : textB.localeCompare(textA);
                });
                taskList.innerHTML = '';
                tasks.forEach(task => taskList.appendChild(task));
                saveTasks(day);
            });
            isSortAscending = !isSortAscending;
            document.querySelector('.filter-sort button').textContent = isSortAscending ? 'Sort A-Z' : 'Sort Z-A';
        }

        // Close sidebar
        function closeSidebar() {
            document.querySelector('.sidebar').classList.remove('active');
        }

        // Sidebar toggle for mobile
        document.querySelector('.sidebar-toggle').addEventListener('click', () => {
            document.querySelector('.sidebar').classList.toggle('active');
        });

        // Keyboard navigation for modal
        document.getElementById('task-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTaskFromModal();
        });

        // Load tasks on page load
        window.onload = loadTasks;
    </script>
</body>
</html>